{% block stylesheets %}
    <link rel="stylesheet" href={{asset("assets/css/style.css")}}>
    <link rel="stylesheet" href={{asset("assets/css/det.css")}}>
    <link rel="stylesheet" href={{asset("assets/css/detb.css")}}>
    <link rel="stylesheet" href={{asset("assets/css/collaps.css")}}>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-aFq/bzH65dt+w6FI2ooMVUpc+21e0SRygnTpmBvdBgSdnuTN7QbdgL+OapgHtvPp" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/450c9bb9e7.js" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>
    <link href="https://fonts.googleapis.com/css2?family=Edu+NSW+ACT+Foundation:wght@600&display=swap" rel="stylesheet">
{% endblock %}
{% block body %}



<body style="background-color: rgb(2, 2, 39); height: 98%; width: 96%;">
    

    
         <div class="asideNav" id="asideNav" onmouseenter="f1()" onmouseleave="f2()">
            
            {% include "aside.html.twig" %}
        </div>
                <div class="main" s id="main">
                   {% include "navii.html.twig" %}
                    <div class="contain">
                        
                        <div class="colo"></div>
                        <div class="conte">
                          {% for cours in c %}
                            <div class="cours">
                                <h4>{{cours.nom}}</h4>
                                <span class="rate" style="margin:auto auto auto 10px; "><i class="fa-solid fa-star"></i><span class="val">{{cours.note}}%</span></span>
                                <p>{{cours.descr}}</p>
                                <div class="coeur" style="gap:15px">
                                   <button type="button" style="background-color: rgb(2,2,39); height: 40px; margin: auto 0;" class="btn btn-secondary"><a style="text-decoration: none; color: beige;" href="{{url('lecon',{'id':cours.id,'idLec':l[0].id})}}"> Commencer</a></button>
                                    <div class="li">
                                        <div class="like" id="unl" onclick="fav()"><a href="{{path('det_cours',{'id':cours.id,'fav':'fav'})}}"><i style="color: rgb(253, 253, 217); font-size: 2rem;" class="fa-regular fa-heart"></a></i></div>
                                        <div class="like hh liked" id="l" onclick="unfav()"><a href="{{path('det_cours',{'id':cours.id,'fav':'unfav'})}}"><i style="color: rgb(253, 253, 217); font-size: 2rem;" class="fa-solid fa-heart"></a></i></div>
                                    </div>
                                </div>
                                <img src="assets/image/{{cours.image}}" alt="">
                                
                            </div>
                             <div class="skil">
                                <h4 style="margin: 0 0 0 -15px; font-weight: 600;">Ce cours</h4>
                                <div class="sk">
                                    <span style="color: cadetblue;"><i style="color: cadetblue;" class="fa-solid fa-book-open"></i> Leçons</span>
                                    {{c1|length}}
                                </div>
                                <div class="sk">
                                    <span style="color: chocolate;"><i style="color: chocolate;" class="fa-regular fa-clock"></i> Duré</span>
                                    {{cours.dure}} hrs
                                </div>
                                <div class="sk">
                                    <span style="color: chartreuse;"><i style="color: chartreuse;" class="fa-solid fa-signal"></i> Niveau</span>
                                    {{cours.niveau}}
                                </div>
                                <div class="sk">
                                    <span style="color: darkgreen;"><i style="color: darkgreen;" class="fa-solid fa-globe"></i> Langue</span>
                                    {{cours.langue}}
                                </div>
                            </div>
                        </div>
                              
                       
                     
                        <div class="collap" style=" position: relative; border: 1px solid #ccc; z-index: 2; background-color: aliceblue; width: 92%; border-radius: 20px 20px 0 0; overflow: hidden; margin: auto; margin-top: -100px;" >
                           
                        <div class="miniNav">
                            <div id="nv1" class="lkj" onclick="b1()"><a class="nav-link actv "  href="#">Leçons</a></div>
                            <div id="nv2" onclick="b2()"><a class="nav-link " href="#">Formateur</a></div>
                            <div id="nv3" onclick="b3()"><a class="nav-link " href="#">Feedbacks</a></div>
                    
                        </div>
                        <div id="b1" class="cntnn" >
                        <div class="collappp " style="width: 100%;  margin: auto; background-color: rgb(253, 253, 217);">
                            {% for ch in c1  %}   
                            <button type="button" class="collapsible" style="font-size:1.7rem; background-color: rgba(253, 253, 217);
                                font-weight:600;">{{ch.nom}}</button>
                                <div class="content" style="background-color: rgba(255, 255, 217);">
                                    {% for lec in l %}
                                            {% if lec.idCh == ch.id %}
                                                <p> - {{ lec.nom}} <a href="{{path('lecon',{'id':cours.id,'idLec':lec.id})}}"> <i style="color:rgba(165, 42, 42, 0.849);" class="fa-solid fa-circle-play"></i></a></p>
                                
                                                {% endif %}
                                
                                           
                                            {% endfor %}
                                    
                                 </div> 
                                 {% endfor %}
                            
                        </div>
                           
                              {% endfor %}
                              </div>
                              <div id="b2" class="form cntnn disp">
                            
                              </div>
                              <div id="b3" class="rating cntnn disp">
                                  <div class="statt">
                                    {% set moy = 0 %}
                                    {% if fd|length %} 
                                    {% set sum = 0 %}
                                    {% for et in etoile %}
                                    
                                        {% set sum = sum + et.rate*et.count %}
                                       
                                    {% endfor %}
                                    {% set moy = sum/fd|length %}
                                    {% endif %}
                                        <div class="part1">Avis des etudiants <span>{{moy|number_format(1)}}</span>
                                            <div class="etoile">
                                                {% if moy|round!=0 %}
                                                    {% for i in 1..(moy|round) %}
                                                        <i style="color: goldenrod" class="fa-solid fa-star"></i>
                                                    {% endfor %} 
                                                {% endif %}
                                                {% if moy|round !=5 %}
                                                    {% for i in 1..(5-moy|round) %}
                                                        <i  class="fa-solid fa-star"></i>
                                                    {% endfor %}  
                                                {% endif %}
                                            </div>
                                        </div>
                                        <div class="part2">
                                            <div class="mm">
                                                <div class="pourc">
                                                    <div id="wid5" class="prc"></div>
                                                </div>
                                                <div class="etoile">
                                                    {% for i in 1..5 %}
                                                        <i style="color: goldenrod" class="fa-solid fa-star"></i>
                                                    {% endfor %}   
                                                </div>
                                          </div>
                                          <div class="mm">
                                                <div class="pourc">
                                                    <div id="wid4" class="prc"></div>
                                                </div>
                                                <div class="etoile">
                                                    {% for i in 1..4 %}
                                                        <i style="color: goldenrod" class="fa-solid fa-star"></i>
                                                    {% endfor %}   
                                                    <i  class="fa-solid fa-star"></i>
                                                </div>
                                          </div>
                                          <div class="mm">
                                                <div class="pourc">
                                                    <div id="wid3" class="prc"></div>
                                                </div>
                                                <div class="etoile">
                                                    {% for i in 1..3 %}
                                                        <i style="color: goldenrod" class="fa-solid fa-star"></i>
                                                    {% endfor %} 
                                                    {% for i in 1..2 %}
                                                        <i  class="fa-solid fa-star"></i>
                                                    {% endfor %}  
                                                
                                                </div>
                                              
                                            </div>
                                          <div class="mm">
                                                <div class="pourc">
                                                    <div id="wid2" class="prc"></div>
                                                </div>
                                                <div class="etoile">
                                                    {% for i in 1..2 %}
                                                        <i style="color: goldenrod" class="fa-solid fa-star"></i>
                                                    {% endfor %} 
                                                    {% for i in 1..3 %}
                                                        <i  class="fa-solid fa-star"></i>
                                                    {% endfor %}  
                                                
                                                </div>
                                            </div>
                                          <div class="mm">
                                                <div class="pourc">
                                                    <div id="wid1" class="prc"></div>
                                                </div>
                                                <div class="etoile">
                                                    
                                                        <i style="color: goldenrod" class="fa-solid fa-star"></i>
                                                    
                                                    {% for i in 1..4 %}
                                                        <i  class="fa-solid fa-star"></i>
                                                    {% endfor %}  
                                                
                                                </div>
                                            </div>
                                            <div class="mm">
                                                <div class="pourc">
                                                    <div id="wid0" class="prc"></div>
                                                </div>
                                                <div class="etoile">
                                                    
                                                       
                                                    
                                                    {% for i in 1..5 %}
                                                        <i  class="fa-solid fa-star"></i>
                                                    {% endfor %}  
                                                
                                                </div>
                                            </div>
                                      </div>
                                      {% if fd|length!=0 %}
                                        
                                      
                                      {% for et in etoile %}
                                      
                                          {% if et.rate == 0 %}
                                          {% set  wid0=et.count*100/fd|length %}
                                          <script> 
                                              document.getElementById('wid0').style.width='{{wid0}}%' 
                                          </script>
                                          {% endif %}
                                          
                                          {% if et.rate == 1 %}
                                          {% set  wid1=et.count*100/fd|length %}
                                          <script> 
                                              document.getElementById('wid1').style.width='{{wid1}}%' 
                                          </script>
                                          {% endif %}
                                          
                                          {% if et.rate == 2 %}
                                          {% set  wid2=et.count*100/fd|length %}
                                          <script> 
                                              document.getElementById('wid2').style.width='{{wid2}}%' 
                                          </script>
                                          {% endif %}
                                          
                                          {% if et.rate == 3 %}
                                          {% set  wid3=et.count*100/fd|length %}
                                          <script> 
                                              document.getElementById('wid3').style.width='{{wid3}}%' 
                                          </script>
                                          {% endif %}
                                          
                                          {% if et.rate == 4 %}
                                            {% set  wid4=et.count*100/fd|length %}
                                          <script> 
                                              document.getElementById('wid4').style.width='{{wid4}}%' 
                                          </script>
                                          {% endif %}
                                          
                                          {% if et.rate == 5 %}
                                          {% set  wid5=et.count*100/fd|length %}
                                          <script> 
                                              document.getElementById('wid5').style.width='{{wid5}}%'  
                                          </script>
                                          {% endif %}
                                          
                                          {% endfor %}
                                          {% endif %}
                                          
                                    </div>
                                    {% for row in fd %}
                                        
                                   
                                    <div class="coments" id="comments-container">
                                        <div class="nom">
                                            <h3>{{row.user}} </h3>
                                            {% if row.rate != 0  %}
                                            {% for i in 1..row.rate %}
                                                <i style="color: goldenrod" class="fa-solid fa-star"></i>
                                            {% endfor %} 
                                            {% endif %}
                                            {% if row.rate !=5 %}
                                            {% for i in 1..(5-row.rate) %}
                                                <i  class="fa-solid fa-star"></i>
                                            {% endfor %} 
                                            {% endif %} 
                                        </div>
                                        <span>{{row.creatAt|date('Y-m-d H:i:s')}} </span>
                                        <p>{{row.comment}}</p>
                                        
                                        <div class="lidi" >
                                            <div class="lik">
                                                <div class="leslike" onclick="like()">
                                                    <div id="lik1"><i class="fa-regular fa-thumbs-up"></i></div>
                                                    <div id="lik2" class="disp"> <i  class="fa-solid fa-thumbs-up disp"></i></div>
                                                </div>
                                                <span id="nb1"> 0</span> 
                                            </div>
                                            <div class="lik">
                                                <div class="leslike" onclick="dislike()">
                                                    <div id="dis1"><i class="fa-regular fa-thumbs-down"></i></div>
                                                    <div id="dis2" class="disp"><i class="fa-solid fa-thumbs-down "></i></div>
                                                </div>
                                                <span id="nb2"> 0</span> 
                                            </div>
                                        </div>
                                       
                                        <script>
                                            const lik1=document.getElementById('lik1');
                                            const lik2=document.getElementById('lik2');
                                            const dis1=document.getElementById('dis1');
                                            const dis2=document.getElementById('dis2');
                                            
                                            function like(){
                                                const nb1=parseInt(document.getElementById('nb1').innerHTML);
                                            const nb2=parseInt(document.getElementById('nb2').innerHTML);
                                                lik1.classList.add('disp');
                                                lik2.classList.remove('disp');
                                                console.log(nb1);
                                                document.getElementById('nb1').innerHTML=nb1+1;
                                                if(dis1.classList=='disp'){
                                                    dis2.classList.add('disp');
                                                    dis1.classList.remove('disp');
                                                    document.getElementById('nb2').innerHTML=nb2-1;
                                                }
                                                
                                            }
                                            function dislike(){
                                                const nb1=parseInt(document.getElementById('nb1').innerHTML);
                                            const nb2=parseInt(document.getElementById('nb2').innerHTML);
                                                dis1.classList.add('disp');
                                                dis2.classList.remove('disp');
                                                console.log(nb1);
                                                document.getElementById('nb2').innerHTML=nb2+1;
                                                console.log(lik1.classList.value)
                                                if(lik1.classList.value =='disp'){
                                                    console.log('rr')
                                                    lik2.classList.add('disp');
                                                    lik1.classList.remove('disp');
                                                    document.getElementById('nb1').innerHTML=nb1-1;
                                                }
                                                
                                            }
                                        </script>
                                    </div>
                                    {% endfor %}
                                    <div id="load-more-container" style="margin: 10px 0; display: flex; justify-content: center;">
                                        <button class="btn btn-secondary" id="load-more">Voir plus <i class="fa-solid fa-arrows-rotate"></i></button>
                                    </div>
                                    <div class="ajtcomnt">
                                        <h3>Laisser un commentaire</h3>
                                        <form class="ff" action="" method="post">
                                            <div class="grp">
                                                <input type="text" name="nom" id="" placeholder="Nom">
                                                <input type="email" name="email" id="" placeholder="Email">
                                            </div>
                                            <select name="review" id="">
                                                <option style="padding: 50px;" value="5">&#9733; &#9733; &#9733; &#9733; &#9733; (5/5)</option>
                                                <option value="4">&#9733; &#9733; &#9733; &#9733; &#9734; (4/5)</option>
                                                <option value="3">&#9733; &#9733; &#9733; &#9734; &#9734; (3/5)</option>
                                                <option value="2">&#9733; &#9733; &#9734; &#9734; &#9734; (2/5)</option>
                                                <option value="1">&#9733; &#9734; &#9734; &#9734; &#9734; (1/5)</option>
                                                <option value="0">&#9734; &#9734; &#9734; &#9734; &#9734; (0/5)</option>
                                            </select>
                                            <textarea  name="comment" id="" cols="60" rows="3" placeholder="Ton commentaire"></textarea>
                                            <button type="submit" name="beg" value="beg" style="background-color: rgb(2, 2, 39); margin: 10px 30px;" class="btn btn-primary">Envoyer</button>
                                        </form>
                                    </div>
                                </div>
                        </div>
                        
                         
                    </div>
                        
                </div>

        </body>
{% endblock %}
{% if f|length >0 %}
<script>
    console.log(2);
    const unl=document.getElementById('unl'),
    l=document.getElementById('l');
    unl.classList.add('liked');
    l.classList.remove('liked');

</script>
{% else %}
<script>
    console.log(3);
    l.classList.add('liked');
    unl.classList.remove('liked');
</script>
{% endif %}
<style>
    .lkj{
        border-bottom: 2px solid rgb(2, 2, 39);
    }
</style>

{% block javascripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        
        const desc=document.querySelectorAll('.decri');
        console.log(desc);
       
      
        const main=document.getElementById("main");
        const nav=document.getElementById("nav");
        const asideNav_span1=document.getElementById("asideNav_span1");
        const asideNav_span2=document.getElementById("asideNav_span2");
        const asideNav_span3=document.getElementById("asideNav_span3");
        const asideNav_span4=document.getElementById("asideNav_span4");

       function f1(){
        console.log('hi');
        main.classList.add("active");
        nav.classList.add('ac')
        asideNav.classList.add('ac')
        asideNav_span1.style.color="white"
        asideNav_span2.style.color="white"
        asideNav_span3.style.color="white"
        asideNav_span4.style.color="white"

        
       }
       function f2(){
        console.log('bye');
        main.classList.remove("active");
        nav.classList.remove('ac')

       }
       var coll = document.getElementsByClassName("collapsible");
       var i;
       
       for (i = 0; i < coll.length; i++) {
         coll[i].addEventListener("click", function() {
           this.classList.toggle("active");
           var content = this.nextElementSibling;
           if (content.style.maxHeight){
             content.style.maxHeight = null;
           } else {
             content.style.maxHeight = content.scrollHeight + "px";
           }
         });
       }
      const cntnn=document.querySelectorAll('.cntnn');
       const b11=document.getElementById('b1'),
       b22=document.getElementById('b2'),
       b33=document.getElementById('b3');

       function b1(){
        console.log('hhh');
        cntnn.forEach(element=>{
            element.classList.add('disp');
        })
        document.getElementById("nv2").classList.remove("lkj");
        document.getElementById("nv3").classList.remove("lkj");
        b11.classList.remove("disp");
        document.getElementById("nv1").classList.add("lkj");
        }
        function b2(){
            cntnn.forEach(element=>{
                element.classList.add('disp');
                
            })
            document.getElementById("nv1").classList.remove("lkj");
            document.getElementById("nv3").classList.remove("lkj");
            b22.classList.remove("disp");
            document.getElementById("nv2").classList.add("lkj");
        }
        function b3(){
            cntnn.forEach(element=>{
                
                element.classList.add('disp');
                
                
            })
            document.getElementById("nv2").classList.remove("lkj");
            document.getElementById("nv1").classList.remove("lkj");
            b33.classList.remove("disp");
            document.getElementById("nv3").classList.add("lkj");
        
        }

        $(document).ready(function() {
            var page = 2;
            var url = '{{ path("det_cours") }}';
            
            $('#load-more').click(function() {
                $.get(url + '?page=' + page, function(data) {
                    $('#comments-container').append(data);
                    page++;
                });
            });
        });
      
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.2.1/chart.min.js"></script>
{% endblock %}
